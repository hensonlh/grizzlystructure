########################################################################################### install and load packagesinstall.packages (ÒadegenetÓ)install.packages (ÒspdepÓ)install.packages (ÒpegasÓ)library(adegenet)library(spdep)library(pegas)########################################################################################### import loci csvg1905loci<-read.loci("g1905succesfulgenoindremoved.csv", loci.sep=",", col.loci=3:23, col.pop="pop", row.names=1)# change to genindg1905loci<- loci2genind(g1905loci)class(g1905loci)########################################################### load xy data as objectg1905xy<-read.csv("meanxyalbersindremoved.csv")######################################################### prep location information, remove individual column names(g1905xy)mean_locations_xy_g1905 <- subset(g1905xy, select = c("x", "y"))names(mean_locations_xy_g1905)set.seed(1)#makes randomization the same every timemean_locations_xy_g1905$x_jitter = jitter(mean_locations_xy_g1905$x, factor = .5, amount = NULL)#adds x jitter column to mean_locations_xymean_locations_xy_g1905$y_jitter = jitter(mean_locations_xy_g1905$y, factor = .5, amount = NULL)# adds y jitter column to mean_locations_xy# need to only have two columns in the xy table, we now have x,y,x_jitter, y_jittermean_locations_jitter_g1905<- subset(mean_locations_xy_g1905, select= c("x_jitter", "y_jitter"))#######################################################sPCA functionmyspcag1905<-spca(g1905loci,mean_locations_jitter_g1905, type=1, scannf = FALSE)plot(myspcag1905)######################################################### want to pull out females only # create genotype file with ancestry assignments and loci calls for females only femaleancind<-read.csv("g1905WGIancestryfemale.csv")fullgeno<-read.csv("g1905succesfulgenoindremoved.csv")femalegeno<-merge(femaleancind,fullgeno, by="individual")write.csv(femalegeno,"g1905genofullfemale.csv")# create meanxy albers for females only albersxy<-read.csv("meanxyalbersindremoved.csv")femalexy<-merge(femaleancind,albersxy, by="individual")write.csv(femalexy,"g1905albersxyfemale.csv")######################################################### import female loci csvfemaleloci<-read.loci("g1905genofullfemale.csv", loci.sep=",", col.loci=2:22, col.pop="pop", row.names=1)femaleloci<- loci2genind(femaleloci)class(femaleloci)########################################################### load xy data as objectfemalexy<-read.csv("g1905albersxyfemale.csv")# change to genind######################################################### prep location information, remove individual column femalexy <- subset(femalexy, select = c("x", "y"))names(femalexy)set.seed(1)#makes randomization the same every timefemalexy$x_jitter = jitter(femalexy$x, factor = .5, amount = NULL)#adds x jitter column femalexy$y_jitter = jitter(femalexy$y, factor = .5, amount = NULL)# adds y jitter column to # need to only have two columns in the xy table, we now have x,y,x_jitter, y_jittermean_locations_jitter_g1905_female<- subset(femalexy, select= c("x_jitter", "y_jitter"))#######################################################sPCA functionmyspcafemale<-spca(femaleloci,mean_locations_jitter_g1905_female, type=1, scannf = FALSE)plot(myspcafemale)######################################################### want to pull out males only # create genotype file with ancestry assignments and loci calls for males only maleancind<-read.csv("g1905WGIancestrymale.csv")fullgeno<-read.csv("g1905succesfulgenoindremoved.csv")malegeno<-merge(maleancind,fullgeno, by="individual")write.csv(malegeno,"g1905genofullmale.csv")# create meanxy albers for males only albersxy<-read.csv("meanxyalbersindremoved.csv")malexy<-merge(maleancind,albersxy, by="individual")write.csv(malexy,"g1905albersxymale.csv")######################################################### import male loci csvmaleloci<-read.loci("g1905genofullmale.csv", loci.sep=",", col.loci=2:22, col.pop="pop", row.names=1)maleloci<- loci2genind(maleloci)class(maleloci)########################################################### load xy data as objectmalexy<-read.csv("g1905albersxymale.csv")# change to genind######################################################### prep location information, remove individual column malexy <- subset(malexy, select = c("x", "y"))names(malexy)set.seed(1)#makes randomization the same every timemalexy$x_jitter = jitter(malexy$x, factor = .5, amount = NULL)#adds x jitter column malexy$y_jitter = jitter(malexy$y, factor = .5, amount = NULL)# adds y jitter column to # need to only have two columns in the xy table, we now have x,y,x_jitter, y_jittermean_locations_jitter_g1905_male<- subset(malexy, select= c("x_jitter", "y_jitter"))#######################################################sPCA functionmyspcamale<-spca(maleloci,mean_locations_jitter_g1905_male, type=1, scannf = FALSE)plot(myspcamale)